<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gacha Pull RNG Simulator</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1"></script>
</head>
<body>
    <div class="container">
        <h1 id="main-title">Gacha RNG Simulator</h1>

        <div class="game-tabs">
            <button class="tab-button active" data-game="wuwa">Wuthering Waves</button>
            <button class="tab-button" data-game="zzz">Zenless Zone Zero</button>
        </div>

        <div class="methodology-section">
            <details>
                <summary><h2>Methodology</h2></summary>
                <div class="methodology-content">
                    <ul>
                        <li>When pulling for both weapons and characters, weapons are pulled first.</li>
                        <li>When spending corals on pulls, 8 corals are always spent if available. These are not counted in the final pull count.</li>
                        <li>When spending corals on sequences, after winning the desired character, 370 corals are spent to buy a sequence if available. Corals are not spent at any other time.</li>
                        <li>Soft pity is calculated at 4% per pull starting at pull 66, 8% at 71, 9% at 76, experimentally observed on <a href="https://wuwatracker.com/" target="_blank">wuwatracker.com</a>.</li>
                    </ul>
                </div>
            </details>
        </div>

        <div class="config-section">
            <h2>Goals</h2>
            <div class="config-grid">
                <div class="config-item">
                    <label for="weaponTarget">Target Weapons:</label>
                    <input type="number" id="weaponTarget" min="0" max="10" value="0">
                </div>

                <div class="config-item">
                    <label for="characterTarget">Target Characters:</label>
                    <input type="number" id="characterTarget" min="0" max="10" value="1">
                </div>

            </div>

            <h2>Parameters</h2>
            <div class="config-grid">
                <div class="config-item">
                    <label for="simulations">Number of Simulations:</label>
                    <input type="number" id="simulations" min="100" max="100000" value="10000">
                </div>

                <div class="config-item">
                    <label for="characterPity">Character Starting Pity:</label>
                    <input type="number" id="characterPity" min="0" max="90" value="0">
                </div>

                <div class="config-item">
                    <label for="weaponPity">Weapon Starting Pity:</label>
                    <input type="number" id="weaponPity" min="0" max="80" value="0">
                </div>

                <div class="config-item" id="sRankGuaranteedItem">
                    <label>Character Guaranteed:</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="guaranteedNo" name="guaranteed" value="false" checked>
                            <label for="guaranteedNo">No</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="guaranteedYes" name="guaranteed" value="true">
                            <label for="guaranteedYes">Yes</label>
                        </div>
                    </div>
                </div>

                <div class="config-item" id="characterGuaranteedItem" style="display: none;">
                    <label>Character Guaranteed:</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="charGuaranteedNo" name="characterGuaranteed" value="false" checked>
                            <label for="charGuaranteedNo">No</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="charGuaranteedYes" name="characterGuaranteed" value="true">
                            <label for="charGuaranteedYes">Yes</label>
                        </div>
                    </div>
                </div>

                <div class="config-item" id="weaponGuaranteedItem" style="display: none;">
                    <label>Weapon Guaranteed:</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="weaponGuaranteedNo" name="weaponGuaranteed" value="false" checked>
                            <label for="weaponGuaranteedNo">No</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="weaponGuaranteedYes" name="weaponGuaranteed" value="true">
                            <label for="weaponGuaranteedYes">Yes</label>
                        </div>
                    </div>
                </div>
            </div>

            <h2><span data-currency="coral">Coral</span> Settings</h2>
            <div class="config-grid">
                <div class="config-item">
                    <label for="startingCorals">Starting <span data-currency="coral">Corals</span>:</label>
                    <input type="number" id="startingCorals" min="0" max="10000" value="0">
                </div>

                <div class="config-item">
                    <label data-game-tooltip="arank">A-rank Characters:</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="aRankM0" name="aRankTier" value="m0">
                            <label for="aRankM0">M0</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="aRankM6" name="aRankTier" value="m6" checked>
                            <label for="aRankM6">M6</label>
                        </div>
                    </div>
                </div>

                <div class="config-item">
                    <label data-game-tooltip="srank">Standard S-rank Characters:</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="sRankM0" name="sRankTier" value="m0" checked>
                            <label for="sRankM0">M0</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="sRankM6" name="sRankTier" value="m6">
                            <label for="sRankM6">M6</label>
                        </div>
                    </div>
                </div>
            </div>

            <h2><span data-currency="coral">Coral</span> Usage Mode</h2>
            <div class="config-grid">
                <div class="config-item radio-item">
                    <input type="radio" id="coralModeNone" name="coralMode" value="none" checked>
                    <label for="coralModeNone">Don't spend <span data-currency="coral">corals</span> (save all)</label>
                </div>

                <div class="config-item radio-item">
                    <input type="radio" id="coralModeReinvest" name="coralMode" value="reinvest">
                    <label for="coralModeReinvest">Reinvest <span data-currency="coral">Corals</span> as Free Pulls (8 <span data-currency="coral">corals</span> = 1 pull)</label>
                </div>

                <div class="config-item radio-item">
                    <input type="radio" id="coralModeSequences" name="coralMode" value="sequences">
                    <label for="coralModeSequences">Buy Sequences with <span data-currency="coral">Corals</span> (370 <span data-currency="coral">corals</span> = 1 character)</label>
                </div>
            </div>

            <button id="runSimulation" class="btn-primary">Run Simulation</button>
        </div>

        <div class="results-section" id="results" style="display: none;">
            <h2>Results</h2>

            <h3 id="pullStatsTitle">Pull Statistics</h3>
            <div class="stats">
                <div class="stat-item">
                    <span class="stat-label" id="avgPullsLabel">Average Pulls:</span>
                    <span class="stat-value" id="avgPulls">-</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label" id="medianPullsLabel">Median Pulls:</span>
                    <span class="stat-value" id="medianPulls">-</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label" id="minPullsLabel">Min Pulls:</span>
                    <span class="stat-value" id="minPulls">-</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label" id="maxPullsLabel">Max Pulls:</span>
                    <span class="stat-value" id="maxPulls">-</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label" id="p90PullsLabel">90th Percentile:</span>
                    <span class="stat-value" id="p90Pulls">-</span>
                </div>
            </div>

            <h3>A-Rank Statistics</h3>
            <div class="stats">
                <div class="stat-item">
                    <span class="stat-label">Average A-Ranks:</span>
                    <span class="stat-value" id="avgARanks">-</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Median A-Ranks:</span>
                    <span class="stat-value" id="medianARanks">-</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Min A-Ranks:</span>
                    <span class="stat-value" id="minARanks">-</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Max A-Ranks:</span>
                    <span class="stat-value" id="maxARanks">-</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">90th Percentile A-Ranks:</span>
                    <span class="stat-value" id="p90ARanks">-</span>
                </div>
            </div>

            <h3 id="coralStatsTitle">Coral Statistics</h3>
            <div class="stats">
                <div class="stat-item">
                    <span class="stat-label" id="avgCoralsLabel">Average Corals:</span>
                    <span class="stat-value" id="avgCorals">-</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label" id="medianCoralsLabel">Median Corals:</span>
                    <span class="stat-value" id="medianCorals">-</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label" id="minCoralsLabel">Min Corals:</span>
                    <span class="stat-value" id="minCorals">-</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label" id="maxCoralsLabel">Max Corals:</span>
                    <span class="stat-value" id="maxCorals">-</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label" id="p90CoralsLabel">90th Percentile Corals:</span>
                    <span class="stat-value" id="p90Corals">-</span>
                </div>
            </div>

            <div class="display-toggle">
                <div>
                    <input type="radio" id="pullsMode" name="displayMode" value="pulls" checked>
                    <label for="pullsMode">Display as Pulls</label>
                </div>
                <div>
                    <input type="radio" id="astritesMode" name="displayMode" value="astrites">
                    <label for="astritesMode">Display as Astrites (160 per pull)</label>
                </div>
            </div>

            <div class="chart-container">
                <canvas id="distributionChart"></canvas>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
